<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thtf.office.mapper.TblVehicleSchedulingMapper">
    <select id="select" parameterType="com.thtf.office.vo.VehicleSchedulingParamVO" resultType="com.thtf.office.entity.TblVehicleScheduling">
        select * from tbl_vehicle_scheduling
        <where>
            delete_time is null
            <if test="id != null">
                and id = #{id}
            </if>
            <if test="carNumber">
                and car_number = #{carNumber}
            </if>
            <if test="vehicleInfoId">
                vehicle_info_id = #{vehicleInfoId}
            </if>
            <if test="code != null">
                and code = #{code}
            </if>
            <if test="vehicleCategoryId">
                and vehicle_category_id = #{vehicleCategoryId}
            </if>
            <if test="userName">
                and user_name = #{userName}
            </if>
            <if test="organizationId">
                and organization_id = #{organizationId}
            </if>
            <if test="organizationName">
                and organization_name = #{organizationName}
            </if>
            <if test="purpose">
                and purpose = #{purpose}
            </if>
            <if test="driverId">
                and driver_id = #{driverId}
            </if>
            <if test="driverName">
                and driver_name = #{driverName}
            </if>
            <if test="startTime">
                and start_time = #{startTime}
            </if>
            <if test="endTime">
                and end_time = #{endTime}
            </if>
        </where>
    </select>
    <!-- 按日、月查询司机的每周月的出车情况 -->
    <select id="selectScheAboutDir" parameterType="java.util.Map" resultType="com.thtf.office.vo.VehicleSelectByDateResult">
        	select driver_id as id , driver_name as attribute,count(*) as ${numberType}
            from tbl_vehicle_scheduling as scheduling
            where scheduling.delete_time is null and DATE_FORMAT(end_time, #{dateTemplate}) = DATE_FORMAT(NOW(), #{dateTemplate})
            group by driver_id
    </select>
</mapper>
